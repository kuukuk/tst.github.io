<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>GPT Spracheingabe</title>
  <style>
    body { font-family: sans-serif; padding: 1rem; }
    button { font-size: 1.2rem; padding: 0.5rem 1rem; }
    #transcript, #response { margin-top: 1rem; white-space: pre-wrap; }
  </style>
</head>
<body>

<h2>ðŸŽ¤ GPT Sprachsteuerung</h2>
<button id="startBtn">Spracheingabe starten</button>
<div id="transcript">ðŸ—£ Du: </div>
<div id="response">ðŸ¤– GPT: </div>

<script>
  const OPENAI_API_KEY = "DEIN_API_KEY_HIER"; // <<< Hier deinen Key einsetzen
  const recognition = new webkitSpeechRecognition();

  recognition.lang = "de-DE";
  recognition.continuous = false;
  recognition.interimResults = false;

  let lastSpokenText = "";
  let timeout = null;

  recognition.onresult = function(event) {
    const spokenText = event.results[0][0].transcript.trim();
    lastSpokenText = spokenText;
    document.getElementById("transcript").textContent = "ðŸ—£ Du: " + spokenText;

    // â³ 5 Sekunden warten, ob noch was kommt
    clearTimeout(timeout);
    timeout = setTimeout(() => {
      sendToChatGPT(lastSpokenText);
    }, 5000); // 5000 ms = 5 Sekunden Denkpause
  };

  recognition.onend = function() {
    // Falls du willst, dass er automatisch neu startet:
    // recognition.start();
  };

  document.getElementById("startBtn").onclick = function() {
    recognition.start();
  };

  async function sendToChatGPT(text) {
    const responseDiv = document.getElementById("response");
    responseDiv.textContent = "ðŸ¤– GPT: Warte auf Antwort...";
    try {
      const result = await fetch("https://api.openai.com/v1/chat/completions", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "Authorization": "Bearer " + OPENAI_API_KEY
        },
        body: JSON.stringify({
          model: "gpt-3.5-turbo", // oder "gpt-4o"
          messages: [{ role: "user", content: text }]
        })
      });
      const data = await result.json();
      const answer = data.choices?.[0]?.message?.content || "Keine Antwort erhalten.";
      responseDiv.textContent = "ðŸ¤– GPT: " + answer;
    } catch (error) {
      responseDiv.textContent = "Fehler: " + error.message;
    }
  }
</script>

</body>
</html>
