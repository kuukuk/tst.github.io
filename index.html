<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>Push Benachrichtigung Test</title>
</head>
<body>
  <h1>Push Test</h1>
  <button id="notifyBtn">Push senden</button>

  <script>
    // Service Worker registrieren
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('sw.js')
        .then(reg => console.log("Service Worker registriert", reg))
        .catch(err => console.error("SW Registrierung fehlgeschlagen", err));
    }

    // Nach Erlaubnis fragen
    function askNotificationPermission() {
      if (!("Notification" in window)) {
        alert("Dieser Browser unterstÃ¼tzt keine Notifications");
      } else if (Notification.permission !== "granted") {
        Notification.requestPermission().then(permission => {
          if (permission !== "granted") {
            alert("Push nicht erlaubt ðŸ˜¢");
          }
        });
      }
    }

    askNotificationPermission();

    // Button-Event
    document.getElementById("notifyBtn").addEventListener("click", async () => {
      if (Notification.permission === "granted") {
        const registration = await navigator.serviceWorker.getRegistration();
        if (registration) {
          registration.showNotification("ðŸ”” Neue Nachricht", {
            body: "Dies ist eine Push-Benachrichtigung!",
            icon: "https://cdn-icons-png.flaticon.com/512/1827/1827392.png",
            vibrate: [100, 50, 100],
            tag: "test-push",
            renotify: true
          });
        } else {
          alert("Kein Service Worker gefunden");
        }
      } else {
        askNotificationPermission();
      }
    });
  </script>
</body>
</html>
